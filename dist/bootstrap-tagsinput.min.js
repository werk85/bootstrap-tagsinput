/*
 * bootstrap-tagsinput v0.8.0
 * 
 */

"use strict";function TagsInput(a,b){this.isInit=!0,this.itemsArray=[],this.$element=$(a),this.$element.hide(),this.isSelect="SELECT"===a.tagName,this.multiple=this.isSelect&&a.hasAttribute("multiple"),this.objectItems=b&&b.itemValue,this.placeholderText=a.hasAttribute("placeholder")?this.$element.attr("placeholder"):"",this.inputSize=Math.max(1,this.placeholderText.length),this.$container=$('<div class="bootstrap-tagsinput"></div>'),this.$input=$('<input type="text" placeholder="'+this.placeholderText+'"/>').appendTo(this.$container),this.$element.before(this.$container),this.build(b),this.isInit=!1}function makeOptionItemFunction(a,b){if("function"!=typeof a[b]){var c=a[b];a[b]=function(a){return a[c]}}}function makeOptionFunction(a,b){if("function"!=typeof a[b]){var c=a[b];a[b]=function(){return c}}}function htmlEncode(a){return a?htmlEncodeContainer.text(a).html():""}function doGetCaretPosition(a){var b=0;if(document.selection){a.focus();var c=document.selection.createRange();c.moveStart("character",-a.value.length),b=c.text.length}else(a.selectionStart||"0"==a.selectionStart)&&(b=a.selectionStart);return b}function keyCombinationInList(a,b){var c=!1;return $.each(b,function(b,d){if("number"==typeof d&&a.which===d)return c=!0,!1;if(a.which===d.which){var e=!d.hasOwnProperty("altKey")||a.altKey===d.altKey,f=!d.hasOwnProperty("shiftKey")||a.shiftKey===d.shiftKey,g=!d.hasOwnProperty("ctrlKey")||a.ctrlKey===d.ctrlKey;if(e&&f&&g)return c=!0,!1}}),c}var defaultOptions={tagClass:function(a){return"label label-info"},focusClass:"focus",itemValue:function(a){return a?a.toString():a},itemText:function(a){return this.itemValue(a)},itemTitle:function(a){return null},freeInput:!0,addOnBlur:!0,maxTags:void 0,maxChars:void 0,confirmKeys:[13,44],delimiter:",",delimiterRegex:null,cancelConfirmKeysOnEmpty:!1,onTagExists:function(a,b){b.hide().fadeIn()},trimValue:!1,allowDuplicates:!1,triggerChange:!0};TagsInput.prototype={constructor:TagsInput,add:function(a,b,c){var d=this;if(!(d.options.maxTags&&d.itemsArray.length>=d.options.maxTags)&&(!1===a||a)){if("string"==typeof a&&d.options.trimValue&&(a=$.trim(a)),"object"==typeof a&&!d.objectItems)throw"Can't add objects when itemValue option is not set";if(!a.toString().match(/^\s*$/)){if(d.isSelect&&!d.multiple&&d.itemsArray.length>0&&d.remove(d.itemsArray[0]),"string"==typeof a&&"INPUT"===this.$element[0].tagName){var e=d.options.delimiterRegex?d.options.delimiterRegex:d.options.delimiter,f=a.split(e);if(f.length>1){for(var g=0;g<f.length;g++)this.add(f[g],!0);return void(b||d.pushVal(d.options.triggerChange))}}var h=d.options.itemValue(a),i=d.options.itemText(a),j=d.options.tagClass(a),k=d.options.itemTitle(a),l=$.grep(d.itemsArray,function(a){return d.options.itemValue(a)===h})[0];if(!l||d.options.allowDuplicates){if(!(d.items().toString().length+a.length+1>d.options.maxInputLength)){var m=$.Event("beforeItemAdd",{item:a,cancel:!1,options:c});if(d.$element.trigger(m),!m.cancel){d.itemsArray.push(a);var n=$('<span class="tag '+htmlEncode(j)+(null!==k?'" title="'+k:"")+'">'+htmlEncode(i)+'<span data-role="remove"></span></span>');n.data("item",a),d.findInputWrapper().before(n),n.after(" ");var o=$('option[value="'+encodeURIComponent(h)+'"]',d.$element).length||$('option[value="'+htmlEncode(h)+'"]',d.$element).length;if(d.isSelect&&!o){var p=$("<option selected>"+htmlEncode(i)+"</option>");p.data("item",a),p.attr("value",h),d.$element.append(p)}b||d.pushVal(d.options.triggerChange),d.options.maxTags!==d.itemsArray.length&&d.items().toString().length!==d.options.maxInputLength||d.$container.addClass("bootstrap-tagsinput-max"),$(".typeahead, .twitter-typeahead",d.$container).length&&d.$input.typeahead("val",""),this.isInit?d.$element.trigger($.Event("itemAddedOnInit",{item:a,options:c})):d.$element.trigger($.Event("itemAdded",{item:a,options:c}))}}}else if(d.options.onTagExists){var q=$(".tag",d.$container).filter(function(){return $(this).data("item")===l});d.options.onTagExists(a,q)}}}},remove:function(a,b,c){var d=this;if(d.objectItems&&(a="object"==typeof a?$.grep(d.itemsArray,function(b){return d.options.itemValue(b)==d.options.itemValue(a)}):$.grep(d.itemsArray,function(b){return d.options.itemValue(b)==a}),a=a[a.length-1]),a){var e=$.Event("beforeItemRemove",{item:a,cancel:!1,options:c});if(d.$element.trigger(e),e.cancel)return;$(".tag",d.$container).filter(function(){return $(this).data("item")===a}).remove(),$("option",d.$element).filter(function(){return $(this).data("item")===a}).remove(),-1!==$.inArray(a,d.itemsArray)&&d.itemsArray.splice($.inArray(a,d.itemsArray),1)}b||d.pushVal(d.options.triggerChange),d.options.maxTags>d.itemsArray.length&&d.$container.removeClass("bootstrap-tagsinput-max"),d.$element.trigger($.Event("itemRemoved",{item:a,options:c}))},removeAll:function(){var a=this;for($(".tag",a.$container).remove(),$("option",a.$element).remove();a.itemsArray.length>0;)a.itemsArray.pop();a.pushVal(a.options.triggerChange)},refresh:function(){var a=this;$(".tag",a.$container).each(function(){var b=$(this),c=b.data("item"),d=a.options.itemValue(c),e=a.options.itemText(c),f=a.options.tagClass(c);if(b.attr("class",null),b.addClass("tag "+htmlEncode(f)),b.contents().filter(function(){return 3==this.nodeType})[0].nodeValue=htmlEncode(e),a.isSelect){$("option",a.$element).filter(function(){return $(this).data("item")===c}).attr("value",d)}})},items:function(){return this.itemsArray},pushVal:function(){var a=this,b=$.map(a.items(),function(b){return a.options.itemValue(b).toString()});a.$element.val(b,!0),a.options.triggerChange&&a.$element.trigger("change")},build:function(a){var b=this;if(b.options=$.extend({},defaultOptions,a),b.objectItems&&(b.options.freeInput=!1),makeOptionItemFunction(b.options,"itemValue"),makeOptionItemFunction(b.options,"itemText"),makeOptionFunction(b.options,"tagClass"),b.options.typeahead){var c=b.options.typeahead||{};makeOptionFunction(c,"source"),b.$input.typeahead($.extend({},c,{source:function(a,d){function e(a){for(var c=[],e=0;e<a.length;e++){var g=b.options.itemText(a[e]);f[g]=a[e],c.push(g)}d(c)}this.map={};var f=this.map,g=c.source(a);$.isFunction(g.success)?g.success(e):$.isFunction(g.then)?g.then(e):$.when(g).then(e)},updater:function(a){return b.add(this.map[a]),this.map[a]},matcher:function(a){return-1!==a.toLowerCase().indexOf(this.query.trim().toLowerCase())},sorter:function(a){return a.sort()},highlighter:function(a){var b=new RegExp("("+this.query+")","gi");return a.replace(b,"<strong>$1</strong>")}}))}if(b.options.typeaheadjs){var d=b.options.typeaheadjs;$.isArray(d)||(d=[null,d]),$.fn.typeahead.apply(b.$input,d).on("typeahead:selected",$.proxy(function(a,c,e){var f=0;d.some(function(a,b){return a.name===e&&(f=b,!0)}),d[f].valueKey?b.add(c[d[f].valueKey]):b.add(c),b.$input.typeahead("val","")},b))}b.$container.on("click",$.proxy(function(a){b.$element.attr("disabled")||b.$input.removeAttr("disabled"),b.$input.focus()},b)),b.options.addOnBlur&&b.options.freeInput&&b.$input.on("focusout",$.proxy(function(a){0===$(".typeahead, .twitter-typeahead",b.$container).length&&(b.add(b.$input.val()),b.$input.val(""))},b)),b.$container.on({focusin:function(){b.$container.addClass(b.options.focusClass)},focusout:function(){b.$container.removeClass(b.options.focusClass)}}),b.$container.on("keydown","input",$.proxy(function(a){var c=$(a.target),d=b.findInputWrapper();if(b.$element.attr("disabled"))return void b.$input.attr("disabled","disabled");switch(a.which){case 8:if(0===doGetCaretPosition(c[0])){var e=d.prev();e.length&&b.remove(e.data("item"))}break;case 46:if(0===doGetCaretPosition(c[0])){var f=d.next();f.length&&b.remove(f.data("item"))}break;case 37:var g=d.prev();0===c.val().length&&g[0]&&(g.before(d),c.focus());break;case 39:var h=d.next();0===c.val().length&&h[0]&&(h.after(d),c.focus())}var i=c.val().length;Math.ceil(i/5);c.attr("size",Math.max(this.inputSize,c.val().length))},b)),b.$container.on("keypress","input",$.proxy(function(a){var c=$(a.target);if(b.$element.attr("disabled"))return void b.$input.attr("disabled","disabled");var d=c.val(),e=b.options.maxChars&&d.length>=b.options.maxChars;b.options.freeInput&&(keyCombinationInList(a,b.options.confirmKeys)||e)&&(0!==d.length&&(b.add(e?d.substr(0,b.options.maxChars):d),c.val("")),!1===b.options.cancelConfirmKeysOnEmpty&&a.preventDefault());var f=c.val().length;Math.ceil(f/5);c.attr("size",Math.max(this.inputSize,c.val().length))},b)),b.$container.on("click","[data-role=remove]",$.proxy(function(a){b.$element.attr("disabled")||b.remove($(a.target).closest(".tag").data("item"))},b)),b.options.itemValue===defaultOptions.itemValue&&("INPUT"===b.$element[0].tagName?b.add(b.$element.val()):$("option",b.$element).each(function(){b.add($(this).attr("value"),!0)}))},destroy:function(){var a=this;a.$container.off("keypress","input"),a.$container.off("click","[role=remove]"),a.$container.remove(),a.$element.removeData("tagsinput"),a.$element.show()},focus:function(){this.$input.focus()},input:function(){return this.$input},findInputWrapper:function(){for(var a=this.$input[0],b=this.$container[0];a&&a.parentNode!==b;)a=a.parentNode;return $(a)}},$.fn.tagsinput=function(a,b,c){var d=[];return this.each(function(){var e=$(this).data("tagsinput");if(e)if(a||b){if(void 0!==e[a]){if(3===e[a].length&&void 0!==c)var f=e[a](b,null,c);else var f=e[a](b);void 0!==f&&d.push(f)}}else d.push(e);else e=new TagsInput(this,a),$(this).data("tagsinput",e),d.push(e),"SELECT"===this.tagName&&$("option",$(this)).attr("selected","selected"),$(this).val($(this).val())}),"string"==typeof a?d.length>1?d:d[0]:d},$.fn.tagsinput.Constructor=TagsInput;var htmlEncodeContainer=$("<div />");$(function(){$("input[data-role=tagsinput], select[multiple][data-role=tagsinput]").tagsinput()});
//# sourceMappingURL=bootstrap-tagsinput.min.js.map